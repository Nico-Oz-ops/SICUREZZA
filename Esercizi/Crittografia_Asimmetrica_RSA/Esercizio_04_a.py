'''
modulus:
    00:cd:6e:e7:d1:4b:5b:15:de:c1:72:c7:a4:ea:a4:
    c4:0c:81:25:a3:8e:93:8e:5d:d7:a2:4a:b0:bd:3f:
    2b:b9:0b:2f:80:96:43:70:c0:36:d3:8e:fd:4b:0b:
    9b:fe:92:9e:54:0c:f2:7f:dc:6f:60:ef:56:b5:e0:
    b0:36:ff:44:5a:71:3b:26:18:02:fc:a5:32:91:eb:
    c0:6f:32:4f:a5:84:aa:a7:49:a2:cc:29:8e:34:5d:
    07:dc:25:a4:0a:ab:cb:7e:ae:00:d9:7c:a4:20:04:
    a5:16:8d:ef:2d:32:f9:2e:91:60:bf:eb:20:0b:78:
    72:4a:20:5a:16:57:4d:bd:f7:0b:e9:48:05:34:e8:
    ac:3b:81:e6:32:1c:68:25:ae:97:43:f0:20:87:38:
    92:77:6b:c5:df:80:a8:3c:d7:56:ae:75:01:1f:52:
    fe:65:eb:79:db:54:5c:81:ca:e7:fb:c9:e5:8e:02:
    86:95:18:60:16:74:a6:17:b0:b5:5d:c4:33:72:10:
    b7:f7:ca:f6:33:16:44:d4:27:be:7e:01:ac:d7:2a:
    f5:e7:66:dc:b9:da:04:9b:4a:a1:f4:a9:46:8a:74:
    30:32:18:8a:d0:a1:08:b1:56:e7:c8:39:64:1d:c8:
    3b:47:99:a9:42:af:d1:27:ba:9f:b9:61:fc:ad:98:
    74:dd
publicExponent: 3 (0x3)
privateExponent:
    06:39:a9:ef:11:cc:75:06:c0:0b:3c:5a:54:af:a8:
    d9:97:4e:b7:61:69:51:e3:d0:3b:38:90:fd:fa:28:
    1c:e1:4f:03:e5:85:ec:24:da:df:9f:7c:0a:08:1b:
    ff:f4:ed:86:6c:ff:97:44:bd:8e:92:e3:98:e7:c7:
    47:7c:19:58:12:f2:46:f8:f8:55:3b:4f:1b:b1:cf:
    87:3f:95:ce:b6:71:c7:02:3b:3c:7d:61:66:6f:6c:
    d8:20:2b:c2:43:44:3a:24:4d:99:fc:04:f9:36:71:
    9b:d5:c1:6d:f9:c9:7d:88:48:bf:ff:5e:0f:dc:dc:
    ac:e9:b5:27:77:02:5b:16:f2:6f:8a:6f:83:11:2d:
    b2:4d:ea:5d:3a:84:68:ba:e2:8e:35:34:ea:2d:52:
    2d:b1:00:fb:e1:f7:c0:11:27:a3:d3:5f:71:42:77:
    51:9b:85:f0:b8:4d:5b:7c:29:6e:6d:25:1a:0d:8d:
    47:21:95:01:55:81:c1:8e:da:6c:b0:64:e9:7d:41:
    b7:ca:d8:fd:b6:19:de:bf:85:e1:98:67:33:36:b4:
    3e:40:53:6a:71:14:dc:21:ab:67:8f:28:00:8a:ca:
    08:81:e8:9b:d5:ef:b5:e4:9a:16:3e:2f:2d:a4:6a:
    d1:7e:c9:b0:c0:c0:f6:c4:d2:7b:87:54:d6:57:88:
    27
'''

modulo = '''
    00:cd:6e:e7:d1:4b:5b:15:de:c1:72:c7:a4:ea:a4:
    c4:0c:81:25:a3:8e:93:8e:5d:d7:a2:4a:b0:bd:3f:
    2b:b9:0b:2f:80:96:43:70:c0:36:d3:8e:fd:4b:0b:
    9b:fe:92:9e:54:0c:f2:7f:dc:6f:60:ef:56:b5:e0:
    b0:36:ff:44:5a:71:3b:26:18:02:fc:a5:32:91:eb:
    c0:6f:32:4f:a5:84:aa:a7:49:a2:cc:29:8e:34:5d:
    07:dc:25:a4:0a:ab:cb:7e:ae:00:d9:7c:a4:20:04:
    a5:16:8d:ef:2d:32:f9:2e:91:60:bf:eb:20:0b:78:
    72:4a:20:5a:16:57:4d:bd:f7:0b:e9:48:05:34:e8:
    ac:3b:81:e6:32:1c:68:25:ae:97:43:f0:20:87:38:
    92:77:6b:c5:df:80:a8:3c:d7:56:ae:75:01:1f:52:
    fe:65:eb:79:db:54:5c:81:ca:e7:fb:c9:e5:8e:02:
    86:95:18:60:16:74:a6:17:b0:b5:5d:c4:33:72:10:
    b7:f7:ca:f6:33:16:44:d4:27:be:7e:01:ac:d7:2a:
    f5:e7:66:dc:b9:da:04:9b:4a:a1:f4:a9:46:8a:74:
    30:32:18:8a:d0:a1:08:b1:56:e7:c8:39:64:1d:c8:
    3b:47:99:a9:42:af:d1:27:ba:9f:b9:61:fc:ad:98:
    74:dd'''

esp_privato = '''
    06:39:a9:ef:11:cc:75:06:c0:0b:3c:5a:54:af:a8:
    d9:97:4e:b7:61:69:51:e3:d0:3b:38:90:fd:fa:28:
    1c:e1:4f:03:e5:85:ec:24:da:df:9f:7c:0a:08:1b:
    ff:f4:ed:86:6c:ff:97:44:bd:8e:92:e3:98:e7:c7:
    47:7c:19:58:12:f2:46:f8:f8:55:3b:4f:1b:b1:cf:
    87:3f:95:ce:b6:71:c7:02:3b:3c:7d:61:66:6f:6c:
    d8:20:2b:c2:43:44:3a:24:4d:99:fc:04:f9:36:71:
    9b:d5:c1:6d:f9:c9:7d:88:48:bf:ff:5e:0f:dc:dc:
    ac:e9:b5:27:77:02:5b:16:f2:6f:8a:6f:83:11:2d:
    b2:4d:ea:5d:3a:84:68:ba:e2:8e:35:34:ea:2d:52:
    2d:b1:00:fb:e1:f7:c0:11:27:a3:d3:5f:71:42:77:
    51:9b:85:f0:b8:4d:5b:7c:29:6e:6d:25:1a:0d:8d:
    47:21:95:01:55:81:c1:8e:da:6c:b0:64:e9:7d:41:
    b7:ca:d8:fd:b6:19:de:bf:85:e1:98:67:33:36:b4:
    3e:40:53:6a:71:14:dc:21:ab:67:8f:28:00:8a:ca:
    08:81:e8:9b:d5:ef:b5:e4:9a:16:3e:2f:2d:a4:6a:
    d1:7e:c9:b0:c0:c0:f6:c4:d2:7b:87:54:d6:57:88:
    27'''

d_clean = esp_privato.replace(":", "").replace(" ", "").replace("\n", "")
n_clean = modulo.replace(":", "").replace(" ", "").replace("\n", "")

d = int(d_clean, 16) # esponente privato
n = int(n_clean, 16) # modulo
e = 3 # esponente pubblico

msg = "Allerta di cioccolato!"

msg_int = int.from_bytes(msg.encode(), "big") # messaggio come numero int

cifra = pow(msg_int, e, n) # messaggio cifrato

decifra = pow(cifra, d, n) # messaggio decifrato

decifra_str = decifra.to_bytes((decifra.bit_length() + 7) // 8, "big").decode() # decifra riconvertito in str

try:
    if decifra_str == msg:
        print("Complimenti, i messaggi coincidono")
    
    else:
        print("Peccato, i messaggi non sono uguali")

except ValueError as e:
    print(f"Errore: {e}")